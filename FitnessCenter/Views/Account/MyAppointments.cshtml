@model List<FitnessCenter.Models.Appointment>
@{
    ViewData["Title"] = "Randevularım";
}

<style>
    .appointments-page {
        min-height: 100vh;
        padding-top: 120px;
        padding-bottom: 80px;
    }
    .appointments-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
    }
    .appointments-header h2 {
        color: #fff;
        font-size: 2rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .appointments-header h2 i {
        color: #00d26a;
        font-size: 1.5rem;
    }
    .btn-add {
        background: linear-gradient(135deg, #00d26a, #00ff88);
        border: none;
        color: #0a0a14;
        font-weight: 600;
        padding: 12px 24px;
        border-radius: 12px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        text-decoration: none;
    }
    .btn-add:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(0, 210, 106, 0.3);
        color: #0a0a14;
    }
    .appointment-card {
        background: linear-gradient(145deg, #12121c 0%, #0d0d14 100%);
        border: 1px solid rgba(0, 210, 106, 0.1);
        border-radius: 20px;
        overflow: hidden;
        height: 100%;
        color: #d6d6d6;
        box-shadow: 0 4px 24px rgba(0,0,0,0.12);
    }
    .appointment-card .card-header {
        background: linear-gradient(135deg, rgba(0,210,106,0.15) 0%, rgba(0,210,106,0.05) 100%);
        border-bottom: 1px solid rgba(0,210,106,0.1);
        color: #fff;
        font-weight: 600;
        font-size: 1.1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 28px;
    }
    .appointment-card .badge {
        font-size: 0.95rem;
        padding: 6px 14px;
        border-radius: 8px;
        font-weight: 600;
    }
    .appointment-card .card-title {
        color: #fff;
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 10px;
    }
    .appointment-card .card-text {
        color: #d6d6d6;
        font-size: 1rem;
    }
    .appointment-card .card-text i {
        color: #00d26a;
    }
    .appointment-card .card-text .line-item {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    .appointment-card .card-text .line-item i {
        flex: 0 0 28px;
        width: 28px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: #00d26a;
        font-size: 1.1rem;
    }
    .appointment-card .card-text .line-item span {
        flex: 1 1 auto;
        display: inline-block;
    }
    .appointment-card .card-footer {
        background: transparent;
        border-top: 1px solid rgba(0,210,106,0.08);
        padding: 14px 28px;
    }
    .appointment-card .btn-outline-danger {
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.97rem;
        padding: 6px 18px;
        border-width: 2px;
    }
    .appointment-card .btn-outline-danger i {
        margin-right: 4px;
    }
    .appointment-card .small.text-muted {
        color: #888 !important;
        font-size: 0.97rem;
        margin-top: 10px;
    }
    .alert-info {
        background: linear-gradient(135deg, #23232e 0%, #18181f 100%);
        color: #d6d6d6;
        border: 1px solid rgba(0,210,106,0.08);
        border-radius: 16px;
        font-size: 1.08rem;
    }
    .alert-info a {
        color: #00d26a;
        text-decoration: underline;
        font-weight: 600;
    }
</style>

<div class="container appointments-page">
    <div class="appointments-header">
        <h2><i class="bi bi-calendar3"></i> Randevularım</h2>
        <a asp-controller="Appointment" asp-action="Create" class="btn-add">
            <i class="bi bi-plus-lg"></i> Yeni Randevu
        </a>
    </div>

    @if (Model.Count == 0)
    {
        <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> Henüz randevunuz bulunmamaktadır.
            <a asp-controller="Appointment" asp-action="Create">Hemen randevu alın!</a>
        </div>
    }
    else
    {
        <div class="row">
            @foreach (var appointment in Model)
            {
                <div class="col-md-6 mb-4">
                    <div class="appointment-card h-100">
                        <div class="card-header">
                            <span>
                                <i class="bi bi-calendar-event"></i>
                                @appointment.AppointmentDate.ToString("dd MMMM yyyy")
                            </span>
                            @{
                                var badgeClass = appointment.Status switch
                                {
                                    FitnessCenter.Models.AppointmentStatus.Pending => "bg-warning text-dark",
                                    FitnessCenter.Models.AppointmentStatus.Confirmed => "bg-success",
                                    FitnessCenter.Models.AppointmentStatus.Cancelled => "bg-danger",
                                    FitnessCenter.Models.AppointmentStatus.Completed => "bg-info",
                                    _ => "bg-secondary"
                                };
                                var statusText = appointment.Status switch
                                {
                                    FitnessCenter.Models.AppointmentStatus.Pending => "Beklemede",
                                    FitnessCenter.Models.AppointmentStatus.Confirmed => "Onaylandı",
                                    FitnessCenter.Models.AppointmentStatus.Cancelled => "İptal Edildi",
                                    FitnessCenter.Models.AppointmentStatus.Completed => "Tamamlandı",
                                    _ => "Bilinmiyor"
                                };
                            }
                            <span class="badge @badgeClass">@statusText</span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">@appointment.Service?.Name</h5>
                            <p class="card-text">
                                <span class="line-item"><i class="bi bi-clock"></i><span>@appointment.AppointmentTime.ToString(@"hh\:mm") - @appointment.EndTime.ToString(@"hh\:mm")</span></span>
                                <span class="line-item"><i class="bi bi-person"></i><span>Antrenör: @appointment.Trainer?.FullName</span></span>
                                <span class="line-item"><i class="bi bi-geo-alt"></i><span>@appointment.Service?.Gym?.Name</span></span>
                                <span class="line-item"><i class="bi bi-cash-stack"></i><span>@appointment.TotalPrice.ToString("N0") ₺</span></span>
                            </p>
                            @if (!string.IsNullOrEmpty(appointment.Notes))
                            {
                                <p class="small text-muted">
                                    <i class="bi bi-chat-text"></i> @appointment.Notes
                                </p>
                            }
                        </div>
                        @if (appointment.Status == FitnessCenter.Models.AppointmentStatus.Pending || 
                             appointment.Status == FitnessCenter.Models.AppointmentStatus.Confirmed)
                        {
                            <div class="card-footer">
                                <form asp-controller="Appointment" asp-action="Cancel" asp-route-id="@appointment.Id" method="post" 
                                      onsubmit="return confirm('Randevuyu iptal etmek istediğinize emin misiniz?');">
                                    <button type="submit" class="btn btn-outline-danger btn-sm">
                                        <i class="bi bi-x-circle"></i> İptal Et
                                    </button>
                                </form>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>
    }
</div>
