@model FitnessCenter.Models.ViewModels.AIRecommendationViewModel
@{
    ViewData["Title"] = "Yapay Zeka Önerileri";
    ViewData["NoTopPadding"] = true;
}

<style>
    .page-header {
        background: linear-gradient(135deg, rgba(0, 210, 106, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
        padding: 60px 0;
        padding-top: 140px;
        margin-bottom: 50px;
        border-bottom: 1px solid rgba(0, 210, 106, 0.2);
    }

    .page-header h1 {
        font-size: 3rem;
        font-weight: 800;
        background: linear-gradient(135deg, #00d26a 0%, #00ff88 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .ai-card {
        background: rgba(26, 26, 46, 0.8);
        border: 1px solid rgba(0, 210, 106, 0.1);
        border-radius: 20px;
        overflow: hidden;
    }

    .ai-card .card-header {
        background: linear-gradient(135deg, #00d26a 0%, #00ff88 100%);
        color: #000;
        padding: 20px 25px;
        border: none;
    }

    .ai-card .card-header h5 {
        font-weight: 700;
    }

    .ai-card .card-body {
        padding: 30px;
    }

    .form-label {
        color: #b8b8b8;
        font-weight: 500;
        margin-bottom: 8px;
    }

    .form-control, .form-select {
        background: rgba(15, 15, 26, 0.8);
        border: 1px solid rgba(0, 210, 106, 0.2);
        color: #fff;
        border-radius: 12px;
        padding: 12px 15px;
        transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
        border-color: #00d26a;
        box-shadow: 0 0 0 3px rgba(0, 210, 106, 0.1);
        background: rgba(15, 15, 26, 0.9);
        color: #fff;
    }

    .form-select option {
        background: #1a1a2e;
        color: #fff;
    }

    .input-group-text {
        background: rgba(0, 210, 106, 0.2);
        border: 1px solid rgba(0, 210, 106, 0.2);
        color: #00d26a;
        border-radius: 0 12px 12px 0;
    }

    .input-group .form-control {
        border-radius: 12px 0 0 12px;
    }

    .btn-ai {
        background: linear-gradient(135deg, #00d26a 0%, #00ff88 100%);
        border: none;
        color: #000;
        font-weight: 700;
        padding: 15px 30px;
        border-radius: 30px;
        font-size: 1.1rem;
        transition: all 0.3s ease;
    }

    .btn-ai:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 30px rgba(0, 210, 106, 0.4);
        color: #000;
    }

    .bmi-card {
        background: rgba(26, 26, 46, 0.8);
        border: 1px solid rgba(0, 210, 106, 0.1);
        border-radius: 20px;
        margin-top: 25px;
    }

    .bmi-card .card-header {
        background: transparent;
        border-bottom: 1px solid rgba(0, 210, 106, 0.1);
        padding: 15px 25px;
        color: #fff;
    }

    .bmi-card .card-body {
        padding: 25px;
    }

    .result-card {
        background: rgba(26, 26, 46, 0.8);
        border: 1px solid rgba(0, 210, 106, 0.2);
        border-radius: 20px;
        overflow: hidden;
    }

    .result-card .card-header {
        background: linear-gradient(135deg, rgba(0, 210, 106, 0.3) 0%, rgba(0, 255, 136, 0.1) 100%);
        padding: 20px 25px;
        border: none;
    }

    .result-card .card-header h5 {
        color: #00d26a;
        font-weight: 700;
    }

    .result-card .card-body {
        padding: 30px;
    }

    .recommendation-content {
        line-height: 1.9;
        color: #e0e0e0;
    }

    .recommendation-content strong {
        color: #00d26a;
    }

    .empty-result {
        text-align: center;
        padding: 60px 30px;
    }

    .empty-result i {
        color: rgba(0, 210, 106, 0.3);
        font-size: 5rem;
        margin-bottom: 25px;
    }

    .feature-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 0;
        color: #b8b8b8;
    }

    .feature-item i {
        color: #00d26a;
        font-size: 1.3rem;
    }

    .alert-custom {
        background: rgba(0, 210, 106, 0.1);
        border: 1px solid rgba(0, 210, 106, 0.3);
        color: #00d26a;
        border-radius: 15px;
        padding: 20px;
    }

    .alert-custom a {
        color: #00ff88;
    }

    .progress {
        background: rgba(0, 210, 106, 0.1);
        border-radius: 10px;
        height: 12px;
    }
</style>

<!-- Page Header -->
<div class="page-header text-center" data-aos="fade-down">
    <div class="container">
        <h1><i class="bi bi-robot"></i> Yapay Zeka Fitness Asistanı</h1>
        <p class="lead text-white-50 mt-3">Kişisel fitness ve beslenme önerilerinizi alın</p>
    </div>
</div>

<div class="container pb-5">
    <div class="row">
        <!-- Sol Taraf - Form -->
        <div class="col-lg-5 mb-4" data-aos="fade-right">
            <div class="ai-card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="bi bi-person-lines-fill"></i> Bilgilerinizi Girin</h5>
                </div>
                <div class="card-body">
                    <form asp-action="GetRecommendation" method="post" id="aiForm">
                        <div class="mb-4">
                            <label asp-for="Height" class="form-label">Boy (cm)</label>
                            <div class="input-group">
                                <input asp-for="Height" type="number" class="form-control" placeholder="175" min="100" max="250">
                                <span class="input-group-text">cm</span>
                            </div>
                            <span asp-validation-for="Height" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Weight" class="form-label">Kilo (kg)</label>
                            <div class="input-group">
                                <input asp-for="Weight" type="number" step="0.1" class="form-control" placeholder="70" min="30" max="300">
                                <span class="input-group-text">kg</span>
                            </div>
                            <span asp-validation-for="Weight" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="Age" class="form-label">Yaş</label>
                            <input asp-for="Age" type="number" class="form-control" placeholder="25" min="10" max="100">
                            <span asp-validation-for="Age" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="BodyType" class="form-label">Vücut Tipi</label>
                            <select asp-for="BodyType" class="form-select">
                                <option value="">Seçin...</option>
                                <option value="Ectomorph">Ektomorf (İnce yapılı)</option>
                                <option value="Mesomorph">Mezomorf (Atletik)</option>
                                <option value="Endomorph">Endomorf (Geniş yapılı)</option>
                            </select>
                            <span asp-validation-for="BodyType" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="FitnessGoal" class="form-label">Fitness Hedefiniz</label>
                            <select asp-for="FitnessGoal" class="form-select">
                                <option value="">Seçin...</option>
                                <option value="WeightLoss">Kilo Vermek</option>
                                <option value="MuscleGain">Kas Kazanmak</option>
                                <option value="Endurance">Dayanıklılık Arttırmak</option>
                                <option value="Flexibility">Esneklik Geliştirmek</option>
                                <option value="GeneralFitness">Genel Fitness</option>
                            </select>
                            <span asp-validation-for="FitnessGoal" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="ActivityLevel" class="form-label">Aktivite Seviyesi</label>
                            <select asp-for="ActivityLevel" class="form-select">
                                <option value="">Seçin...</option>
                                <option value="Sedentary">Hareketsiz (Masa başı iş)</option>
                                <option value="LightlyActive">Az Aktif (Hafif egzersiz)</option>
                                <option value="ModeratelyActive">Orta Aktif (3-5 gün spor)</option>
                                <option value="VeryActive">Çok Aktif (Günlük spor)</option>
                                <option value="ExtremelyActive">Aşırı Aktif (Profesyonel sporcu)</option>
                            </select>
                            <span asp-validation-for="ActivityLevel" class="text-danger"></span>
                        </div>

                        <div class="mb-4">
                            <label asp-for="HealthConditions" class="form-label">Sağlık Durumu (Opsiyonel)</label>
                            <textarea asp-for="HealthConditions" class="form-control" rows="2" 
                                      placeholder="Varsa kronik hastalık, alerji vb."></textarea>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-ai" id="submitBtn">
                                <i class="bi bi-magic"></i> Öneri Al
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- BMI Hesaplama -->
            <div class="bmi-card">
                <div class="card-header">
                    <h6 class="mb-0"><i class="bi bi-calculator text-primary-custom"></i> Vücut Kitle İndeksi (BMI)</h6>
                </div>
                <div class="card-body">
                    <div id="bmiResult" class="text-center">
                        <p class="text-white-50">Boy ve kilo bilgilerini girin</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sağ Taraf - Sonuçlar -->
        <div class="col-lg-7" data-aos="fade-left">
            @if (!string.IsNullOrEmpty(Model?.Recommendation))
            {
                <!-- Öneriler -->
                <div class="result-card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-lightning-charge-fill"></i> Kişiselleştirilmiş Öneriler</h5>
                    </div>
                    <div class="card-body">
                        <div class="recommendation-content">
                            @Html.Raw(Model.Recommendation?.Replace("\n", "<br>"))
                        </div>
                    </div>
                </div>

                <div class="alert-custom">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>Not:</strong> Bu öneriler genel bilgi amaçlıdır. Detaylı program için antrenörlerimize danışmanızı öneririz.
                    <a asp-controller="Trainer" asp-action="Index">Antrenörlerimizi inceleyin →</a>
                </div>
            }
            else
            {
                <div class="result-card">
                    <div class="card-body empty-result">
                        <i class="bi bi-robot"></i>
                        <h4 class="text-white mb-3">Kişiselleştirilmiş Öneriler</h4>
                        <p class="text-white-50 mb-4">
                            Soldaki formu doldurarak yapay zeka destekli kişiselleştirilmiş 
                            egzersiz ve beslenme önerilerinizi alabilirsiniz.
                        </p>
                        <div class="row text-start mt-4">
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Vücut tipinize özel egzersizler</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Hedeflerinize yönelik program</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Kişiselleştirilmiş beslenme planı</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Günlük kalori hesaplama</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        const heightInput = document.getElementById('Height');
        const weightInput = document.getElementById('Weight');
        const bmiResult = document.getElementById('bmiResult');

        function calculateBMI() {
            const height = parseFloat(heightInput.value) / 100;
            const weight = parseFloat(weightInput.value);

            if (height > 0 && weight > 0) {
                const bmi = weight / (height * height);
                let category, colorClass;

                if (bmi < 18.5) {
                    category = 'Zayıf';
                    colorClass = 'text-info';
                } else if (bmi < 25) {
                    category = 'Normal';
                    colorClass = 'text-primary-custom';
                } else if (bmi < 30) {
                    category = 'Fazla Kilolu';
                    colorClass = 'text-warning';
                } else {
                    category = 'Obez';
                    colorClass = 'text-danger';
                }

                bmiResult.innerHTML = `
                    <h2 class="${colorClass}" style="font-size: 2.5rem; font-weight: 800;">${bmi.toFixed(1)}</h2>
                    <p class="${colorClass} mb-3"><strong>${category}</strong></p>
                    <div class="progress mt-3">
                        <div class="progress-bar" style="width: ${Math.min(bmi * 2, 100)}%; background: linear-gradient(135deg, #00d26a 0%, #00ff88 100%);"></div>
                    </div>
                    <div class="d-flex justify-content-between mt-2 text-white-50" style="font-size: 0.8rem;">
                        <small>18.5</small>
                        <small>25</small>
                        <small>30+</small>
                    </div>
                `;
            }
        }

        heightInput.addEventListener('input', calculateBMI);
        weightInput.addEventListener('input', calculateBMI);

        document.getElementById('aiForm').addEventListener('submit', function() {
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Analiz Ediliyor...';
        });
    </script>
}
